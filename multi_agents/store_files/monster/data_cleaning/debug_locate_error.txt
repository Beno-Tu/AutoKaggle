The error is caused by the following code snippet:

```python
train_df = detect_and_handle_outliers_iqr(
    data=train_df.copy(),  # Work on a copy to preserve original data
    columns=numerical_cols,
    factor=3.0,              # Increased factor to reduce sensitivity
    method='cap'             # Changed method from 'remove' to 'cap'
)
```