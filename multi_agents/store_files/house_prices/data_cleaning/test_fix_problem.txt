## CODE SNIPPET 1 AFTER CORRECTION ##
```python
# Define columns with missing values
numerical_cols_with_missing = [
    'LotFrontage', 'MasVnrArea', 'GarageYrBlt', 
    'BsmtFinSF1', 'BsmtFinSF2', 'BsmtUnfSF', 'TotalBsmtSF', 
    'BsmtFullBath', 'BsmtHalfBath', 'GarageCars', 'GarageArea'
]

categorical_cols_with_missing = [
    'Alley', 'PoolQC', 'Fence', 'MiscFeature', 'BsmtQual', 
    'BsmtCond', 'BsmtExposure', 'BsmtFinType1', 'BsmtFinType2', 
    'Electrical', 'GarageType', 'GarageFinish', 'GarageQual', 
    'GarageCond', 'MSZoning', 'Utilities', 'Exterior1st', 
    'Exterior2nd', 'KitchenQual', 'Functional', 'SaleType'
]

# Handle missing values for numerical columns using median
train_df = fill_missing_values(train_df, numerical_cols_with_missing, method='median')
test_df = fill_missing_values(test_df, numerical_cols_with_missing, method='median')

# Handle missing values for categorical columns using 'Missing'
train_df = fill_missing_values(train_df, categorical_cols_with_missing, method='constant', fill_value='Missing')
test_df = fill_missing_values(test_df, categorical_cols_with_missing, method='constant', fill_value='Missing')
```

## CODE SNIPPET 2 AFTER CORRECTION ##
```python
# Define columns with missing values
numerical_cols_with_missing = [
    'LotFrontage', 'MasVnrArea', 'GarageYrBlt', 
    'BsmtFinSF1', 'BsmtFinSF2', 'BsmtUnfSF', 'TotalBsmtSF', 
    'BsmtFullBath', 'BsmtHalfBath', 'GarageCars', 'GarageArea'
]

categorical_cols_with_missing = [
    'Alley', 'PoolQC', 'Fence', 'MiscFeature', 'BsmtQual', 
    'BsmtCond', 'BsmtExposure', 'BsmtFinType1', 'BsmtFinType2', 
    'Electrical', 'GarageType', 'GarageFinish', 'GarageQual', 
    'GarageCond', 'MSZoning', 'Utilities', 'Exterior1st', 
    'Exterior2nd', 'KitchenQual', 'Functional', 'SaleType'
]

# Handle missing values for numerical columns using median
train_df = fill_missing_values(train_df, numerical_cols_with_missing, method='median')
test_df = fill_missing_values(test_df, numerical_cols_with_missing, method='median')

# Handle missing values for categorical columns using 'Missing'
train_df = fill_missing_values(train_df, categorical_cols_with_missing, method='constant', fill_value='Missing')
test_df = fill_missing_values(test_df, categorical_cols_with_missing, method='constant', fill_value='Missing')
```